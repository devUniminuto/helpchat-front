{"ast":null,"code":"import FullBoxVue from \"../components/static/FullBox.vue\";\nimport MiddleBox from \"@/components/static/MiddleBox.vue\";\nimport { getArchivosCandidato, subirArchivosCandidato, getPeticionCandidato, downloadFile, eliminarArchivosCandidato, finalizarSubirArchivosCandidato } from '@/api';\nexport default {\n  data() {\n    return {\n      idSolicitudRef: \"\",\n      infoSolicitud: {},\n      infoSolicitudCandidatos: {},\n      componentKey: 1,\n      estadoSolicitud: null,\n      estados: null,\n      idSolicitud: this.$route.params.id,\n      archivosSubidos: [],\n      Images: null,\n      valido: false,\n      userSearchSelected: [],\n      userSearch: []\n    };\n  },\n  methods: {\n    finalizarSubirArchivos() {\n      finalizarSubirArchivosCandidato(this.idSolicitudRef).then(function (response) {\n        window.location.reload();\n      }.bind(this));\n    },\n    eliminarArchivo(id) {\n      eliminarArchivosCandidato(id).then(function (response) {\n        console.log(response.data);\n        this.realizarConsultaArchivos();\n      }.bind(this));\n    },\n    uploadFile() {\n      this.Images = this.$refs.file.files[0];\n    },\n    realizarConsulta() {\n      getPeticionCandidato(this.idSolicitud).then(function (response) {\n        try {\n          this.idSolicitudRef = response.data.id;\n          this.valido = true;\n          this.componentKey += 1;\n          this.realizarConsultaArchivos();\n        } catch {\n          this.valido = false;\n        }\n      }.bind(this));\n    },\n    realizarConsultaArchivos() {\n      getArchivosCandidato(this.idSolicitudRef).then(function (response) {\n        this.archivosSubidos = response.data;\n      }.bind(this));\n    },\n    subirArchivo() {\n      const formData = new FormData();\n      formData.append(\"file\", this.Images);\n      formData.append(\"idSolicitud\", this.idSolicitudRef);\n      subirArchivosCandidato(formData).then(function (response) {\n        const Toast = this.$swal.mixin({\n          toast: true,\n          position: \"top-end\",\n          showConfirmButton: false,\n          timer: 3000,\n          timerProgressBar: true,\n          didOpen: toast => {\n            toast.addEventListener(\"mouseenter\", this.$swal.stopTimer);\n            toast.addEventListener(\"mouseleave\", this.$swal.resumeTimer);\n          }\n        });\n        Toast.fire({\n          icon: \"success\",\n          title: \"Solicitud enviada exitosamente\"\n        });\n        this.realizarConsultaArchivos();\n      }.bind(this));\n    },\n    descargarArchivos(filepath) {\n      downloadFile(filepath).then(response => {\n        console.log(response.data);\n        let fileName = filepath.split(\"/\")[3];\n        const url = window.URL.createObjectURL(new Blob([response.data]));\n        const link = document.createElement(\"a\");\n        link.href = url;\n        link.setAttribute(\"download\", fileName);\n        document.body.appendChild(link);\n        link.click();\n      });\n    }\n  },\n  mounted() {\n    this.realizarConsulta();\n  },\n  components: {\n    FullBoxVue,\n    MiddleBox\n  }\n};","map":{"version":3,"mappings":"AAoEA;AACA;AACA;AACA;EACAA;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IAEAC;MACAC,0DACA;QACAC;MACA,aACA;IACA;IACAC;MACAC,mCACA;QACAC;QACA;MACA,aACA;IACA;IAEAC;MACA;IACA;IAEAC;MACAC,4CACA;QACA;UACA;UACA;UACA;UACA;QACA,EACA;UACA;QACA;MACA,aACA;IACA;IAEAC;MACAC,+CACA;QACA;MACA,aACA;IACA;IAEAC;MACA;MACAC;MACAA;MAEAC,sCACA;QACA;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;YACAL;YACAA;UACA;QACA;QACAM;UACAC;UACAC;QACA;QACA;MACA,aACA;IACA;IAEAC;MACAC;QACAnB;QACA;QACA;QACA;QACAoB;QACAA;QACAC;QACAD;MACA;IACA;EACA;EAEAE;IACA;EAEA;EAEAC;IACAC;IACAC;EACA;AACA","names":["data","idSolicitudRef","infoSolicitud","infoSolicitudCandidatos","componentKey","estadoSolicitud","estados","idSolicitud","archivosSubidos","Images","valido","userSearchSelected","userSearch","methods","finalizarSubirArchivos","finalizarSubirArchivosCandidato","window","eliminarArchivo","eliminarArchivosCandidato","console","uploadFile","realizarConsulta","getPeticionCandidato","realizarConsultaArchivos","getArchivosCandidato","subirArchivo","formData","subirArchivosCandidato","toast","position","showConfirmButton","timer","timerProgressBar","didOpen","Toast","icon","title","descargarArchivos","downloadFile","link","document","mounted","components","FullBoxVue","MiddleBox"],"sourceRoot":"src/views","sources":["subirDatosEvaluadoView.vue"],"sourcesContent":["<template>\n  <div v-if=\"valido\">\n    <FullBoxVue>\n      <h1>¡Hola Candidato!</h1>\n      <p>Por favor suba los archivos relacionados con la solicitud emitida hacia Colpryst.</p>\n    </FullBoxVue>\n    <FullBoxVue class=\"shadowHover\">\n      <div>\n        <h2>Subir archivo nuevo</h2>\n        <input type=\"file\" @change=\"uploadFile\" ref=\"file\" />\n        &nbsp;\n        <v-btn color=\"success\" @click=\"subirArchivo()\">Subir archivo</v-btn>\n        <br /><br />\n      </div>\n\n      <v-container>\n        <h2>Archivos subidos por colaboradores</h2>\n        Pulse encima del archivo para descargar\n        <br /><br />\n        <v-row dense>\n          <v-col\n            class=\"mb-5\"\n            cols=\"2\"\n            v-for=\"(archivo, index) in archivosSubidos\"\n            :key=\"index\"\n          >\n            <v-card class=\"archivo shadowHover\">\n              <v-btn\n                color=\"pink\"\n                fab\n                dark\n                small\n                absolute\n                top\n                left\n                @click=\"eliminarArchivo(archivo.id)\"\n              >\n                <v-icon>mdi-close</v-icon>\n              </v-btn>\n              <div @click=\"descargarArchivos(archivo.archivo)\" class=\"\">\n                <v-icon size=\"100px\"> mdi-file-chart </v-icon>\n                <br />\n                {{ archivo.archivo.split(\"/\")[3] }}\n                <br />\n                <h6>Fecha subida: {{ archivo.creado }}</h6>\n                <h6>Subido por: {{ archivo.subidoPor }}</h6>\n              </div>\n            </v-card>\n          </v-col>\n        </v-row>\n      </v-container>\n    </FullBoxVue>\n    <FullBoxVue>\n      Pulse el siguiente botón sólo cuando <b>esté seguro que subió los archivos necesarios</b>.\n\n      <br>\n      <v-btn color=\"error\" @click=\"finalizarSubirArchivos()\">Finalizar proceso de subir archivos</v-btn>\n    </FullBoxVue>\n  </div>\n  <div v-else>\n    <br>\n    <FullBoxVue>\n      <h1>¡Este enlace no es válido!</h1>\n    </FullBoxVue>\n  </div>\n</template>\n\n<script>\nimport FullBoxVue from \"../components/static/FullBox.vue\";\nimport MiddleBox from \"@/components/static/MiddleBox.vue\";\nimport { getArchivosCandidato, subirArchivosCandidato, getPeticionCandidato, downloadFile, eliminarArchivosCandidato, finalizarSubirArchivosCandidato } from '@/api';\nexport default {\n  data() {\n    return {\n      idSolicitudRef: \"\",\n      infoSolicitud: {},\n      infoSolicitudCandidatos: {},\n      componentKey: 1,\n      estadoSolicitud: null,\n      estados: null,\n      idSolicitud: this.$route.params.id,\n      archivosSubidos: [],\n      Images: null,\n      valido: false,\n      userSearchSelected: [],\n      userSearch: [],\n    };\n  },\n\n  methods: {\n\n    finalizarSubirArchivos(){\n      finalizarSubirArchivosCandidato(this.idSolicitudRef).then(\n        function (response) {\n          window.location.reload();\n        }.bind(this)\n      )\n    },\n    eliminarArchivo(id) {\n      eliminarArchivosCandidato(id).then(\n        function (response) {\n          console.log(response.data);\n          this.realizarConsultaArchivos();\n        }.bind(this)\n      );\n    },\n\n    uploadFile() {\n      this.Images = this.$refs.file.files[0];\n    },\n\n    realizarConsulta() {\n      getPeticionCandidato(this.idSolicitud).then(\n        function (response) {\n          try{\n          this.idSolicitudRef = response.data.id;\n          this.valido = true;\n          this.componentKey += 1;\n          this.realizarConsultaArchivos();\n          }\n          catch{\n            this.valido = false;\n          }\n        }.bind(this)\n      );\n    },\n\n    realizarConsultaArchivos() {\n      getArchivosCandidato(this.idSolicitudRef).then(\n        function (response) {\n          this.archivosSubidos = response.data;\n        }.bind(this)\n      );\n    },\n\n    subirArchivo() {\n      const formData = new FormData();\n      formData.append(\"file\", this.Images);\n      formData.append(\"idSolicitud\", this.idSolicitudRef);\n\n      subirArchivosCandidato(formData).then(\n        function (response) {\n          const Toast = this.$swal.mixin({\n            toast: true,\n            position: \"top-end\",\n            showConfirmButton: false,\n            timer: 3000,\n            timerProgressBar: true,\n            didOpen: (toast) => {\n              toast.addEventListener(\"mouseenter\", this.$swal.stopTimer);\n              toast.addEventListener(\"mouseleave\", this.$swal.resumeTimer);\n            },\n          });\n          Toast.fire({\n            icon: \"success\",\n            title: \"Solicitud enviada exitosamente\",\n          });\n          this.realizarConsultaArchivos();\n        }.bind(this)\n      );\n    },\n\n    descargarArchivos(filepath) {\n      downloadFile(filepath).then((response) => {\n        console.log(response.data)\n        let fileName = filepath.split(\"/\")[3];\n        const url = window.URL.createObjectURL(new Blob([response.data]));\n        const link = document.createElement(\"a\");\n        link.href = url;\n        link.setAttribute(\"download\", fileName);\n        document.body.appendChild(link);\n        link.click();\n      });\n    },\n  },\n\n  mounted() {\n    this.realizarConsulta();\n\n  },\n\n  components: {\n    FullBoxVue,\n    MiddleBox\n  },\n};\n</script>\n\n<style></style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}